\subsection{gpio\+\_\+source\+\_\+s\+\_\+impl.\+h}
\label{gpio__source__s__impl_8h_source}\index{/home/erik/prefix/default/src/gr-\/radar-\/dev/lib/gpio\+\_\+source\+\_\+s\+\_\+impl.\+h@{/home/erik/prefix/default/src/gr-\/radar-\/dev/lib/gpio\+\_\+source\+\_\+s\+\_\+impl.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{/* -*- c++ -*- */}
00002 \textcolor{comment}{/*}
00003 \textcolor{comment}{ * Copyright 2018 <+YOU OR YOUR COMPANY+>.}
00004 \textcolor{comment}{ *}
00005 \textcolor{comment}{ * This is free software; you can redistribute it and/or modify}
00006 \textcolor{comment}{ * it under the terms of the GNU General Public License as published by}
00007 \textcolor{comment}{ * the Free Software Foundation; either version 3, or (at your option)}
00008 \textcolor{comment}{ * any later version.}
00009 \textcolor{comment}{ *}
00010 \textcolor{comment}{ * This software is distributed in the hope that it will be useful,}
00011 \textcolor{comment}{ * but WITHOUT ANY WARRANTY; without even the implied warranty of}
00012 \textcolor{comment}{ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}
00013 \textcolor{comment}{ * GNU General Public License for more details.}
00014 \textcolor{comment}{ *}
00015 \textcolor{comment}{ * You should have received a copy of the GNU General Public License}
00016 \textcolor{comment}{ * along with this software; see the file COPYING.  If not, write to}
00017 \textcolor{comment}{ * the Free Software Foundation, Inc., 51 Franklin Street,}
00018 \textcolor{comment}{ * Boston, MA 02110-1301, USA.}
00019 \textcolor{comment}{ */}
00020 
00021 \textcolor{preprocessor}{#ifndef INCLUDED\_RADAR\_GPIO\_SOURCE\_S\_IMPL\_H}
00022 \textcolor{preprocessor}{#define INCLUDED\_RADAR\_GPIO\_SOURCE\_S\_IMPL\_H}
00023 
00024 \textcolor{preprocessor}{#include <radar/gpio_source_s.h>}
00025 
00026 \textcolor{comment}{//soapy}
00027 \textcolor{preprocessor}{#include <SoapySDR/Device.hpp>}
00028 \textcolor{preprocessor}{#include <SoapySDR/Time.hpp>}\textcolor{comment}{//}
00029 \textcolor{preprocessor}{#include <SoapySDR/Version.hpp>}
00030 
00031 
00032 \textcolor{comment}{//boost}
00033 \textcolor{preprocessor}{#include <boost/shared\_ptr.hpp>}
00034 \textcolor{preprocessor}{#include <boost/utility.hpp>}
00035 \textcolor{preprocessor}{#include <boost/thread/thread.hpp>}
00036 
00037 \textcolor{preprocessor}{#include <chrono>}
00038 
00039 \textcolor{keyword}{namespace }gr \{
00040   \textcolor{keyword}{namespace }radar \{
00041 
00042     \textcolor{keyword}{class }gpio_source_s_impl : \textcolor{keyword}{public} gpio_source_s
00043     \{
00044      \textcolor{keyword}{private}:
00045        std::string d_device_args;
00046        \textcolor{keywordtype}{int} d_pins;
00047        \textcolor{keywordtype}{int} d_samp_rate;
00048 
00049        SoapySDR::Kwargs d_kw;
00050        SoapySDR::Device *d_soapysdr;
00051 
00052 
00053        std::vector<std::string> d_listRegInterfaces;
00054        std::vector<std::string> d_GPIOBanks;
00055 
00056        \textcolor{keywordtype}{unsigned} d_register;
00057        int16\_t  d_value;
00058        std::vector<int16\_t> Chirp_Sync;
00059 
00060        \textcolor{keyword}{volatile} int16\_t d_readValue;
00061        \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} d_deltaTime_Total;
00062        \textcolor{keywordtype}{float} d_deltaTime_Average = 0;
00063        \textcolor{keywordtype}{float} d_deltaTime_Average_Running = 0;
00064 
00065        \textcolor{keywordtype}{int} d_num_works = 1;
00066        \textcolor{keywordtype}{bool} firstPacket;
00067 
00068        std::chrono::steady\_clock::time\_point t1;
00069        std::chrono::steady\_clock::time\_point t2;
00070 
00071        \textcolor{keywordtype}{int} d_noutput_items;
00072        gr::thread::thread d_thread_readGPIO;
00073 
00074 
00075      \textcolor{keyword}{public}:
00076       gpio_source_s_impl(std::string device\_args, \textcolor{keywordtype}{int} pins, \textcolor{keywordtype}{int} sample\_rate);
00077       ~gpio_source_s_impl();
00078 
00079       \textcolor{keywordtype}{void} readGPIO();
00080 
00081       \textcolor{comment}{// Where all the action really happens}
00082       \textcolor{keywordtype}{int} work(\textcolor{keywordtype}{int} noutput\_items,
00083          gr\_vector\_const\_void\_star &input\_items,
00084          gr\_vector\_void\_star &output\_items);
00085     \};
00086 
00087   \} \textcolor{comment}{// namespace radar}
00088 \} \textcolor{comment}{// namespace gr}
00089 
00090 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* INCLUDED\_RADAR\_GPIO\_SOURCE\_S\_IMPL\_H */}\textcolor{preprocessor}{}
\end{DoxyCode}
