\subsection{print\+\_\+results\+\_\+impl.\+cc}
\label{print__results__impl_8cc_source}\index{/home/erik/prefix/default/src/gr-\/radar-\/dev/lib/print\+\_\+results\+\_\+impl.\+cc@{/home/erik/prefix/default/src/gr-\/radar-\/dev/lib/print\+\_\+results\+\_\+impl.\+cc}}

\begin{DoxyCode}
00001 \textcolor{comment}{/* -*- c++ -*- */}
00002 \textcolor{comment}{/* }
00003 \textcolor{comment}{ * Copyright 2014 Communications Engineering Lab, KIT.}
00004 \textcolor{comment}{ * }
00005 \textcolor{comment}{ * This is free software; you can redistribute it and/or modify}
00006 \textcolor{comment}{ * it under the terms of the GNU General Public License as published by}
00007 \textcolor{comment}{ * the Free Software Foundation; either version 3, or (at your option)}
00008 \textcolor{comment}{ * any later version.}
00009 \textcolor{comment}{ * }
00010 \textcolor{comment}{ * This software is distributed in the hope that it will be useful,}
00011 \textcolor{comment}{ * but WITHOUT ANY WARRANTY; without even the implied warranty of}
00012 \textcolor{comment}{ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}
00013 \textcolor{comment}{ * GNU General Public License for more details.}
00014 \textcolor{comment}{ * }
00015 \textcolor{comment}{ * You should have received a copy of the GNU General Public License}
00016 \textcolor{comment}{ * along with this software; see the file COPYING.  If not, write to}
00017 \textcolor{comment}{ * the Free Software Foundation, Inc., 51 Franklin Street,}
00018 \textcolor{comment}{ * Boston, MA 02110-1301, USA.}
00019 \textcolor{comment}{ */}
00020  
00021 \textcolor{preprocessor}{#ifdef HAVE\_CONFIG\_H}
00022 \textcolor{preprocessor}{#include "config.h"}
00023 \textcolor{preprocessor}{#endif}
00024 
00025 \textcolor{preprocessor}{#include <gnuradio/io\_signature.h>}
00026 \textcolor{preprocessor}{#include "print_results_impl.h"}
00027 \textcolor{preprocessor}{#include <iostream>}
00028 
00029 \textcolor{keyword}{namespace }gr \{
00030   \textcolor{keyword}{namespace }radar \{
00031 
00032     print_results::sptr
00033     print_results::make(\textcolor{keywordtype}{bool} store\_msg, \textcolor{keyword}{const} std::string filename)
00034     \{
00035       \textcolor{keywordflow}{return} gnuradio::get\_initial\_sptr
00036         (\textcolor{keyword}{new} print_results_impl(store\_msg, filename));
00037     \}
00038 
00039     \textcolor{comment}{/*}
00040 \textcolor{comment}{     * The private constructor}
00041 \textcolor{comment}{     */}
00042     print_results_impl::print_results_impl(\textcolor{keywordtype}{bool} store\_msg, \textcolor{keyword}{const} std::string 
      filename)
00043       : gr::block(\textcolor{stringliteral}{"print\_results"},
00044               gr::io\_signature::make(0,0,0),
00045               gr::io\_signature::make(0,0,0))
00046     \{
00047         d_filename = filename;
00048         d_store_msg = store\_msg;
00049         
00050         \textcolor{comment}{// Register input message port}
00051         d_port_id_in = pmt::mp(\textcolor{stringliteral}{"Msg in"});
00052         message\_port\_register\_in(d_port_id_in);
00053         set\_msg\_handler(d_port_id_in, boost::bind(&
      print_results_impl::handle_msg, \textcolor{keyword}{this}, \_1));
00054     \}
00055 
00056     \textcolor{comment}{/*}
00057 \textcolor{comment}{     * Our virtual destructor.}
00058 \textcolor{comment}{     */}
00059     print_results_impl::~print_results_impl()
00060     \{
00061     \}
00062     
00063     \textcolor{keywordtype}{void}
00064     print_results_impl::handle_msg(pmt::pmt\_t msg)
00065     \{
00066         \textcolor{keywordflow}{if}(d_store_msg) d_file.open(d_filename.c\_str(), std::ios::app);
00067         
00068         std::cout << \textcolor{stringliteral}{"// Print results"} << std::endl;
00069         \textcolor{keywordflow}{if}(d_store_msg) d_file << \textcolor{stringliteral}{"// Print results"} << std::endl;
00070         \textcolor{comment}{// Get size of pmt list}
00071         d_size_msg = pmt::length(msg);
00072         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0; k<d_size_msg; k++)\{
00073             d_msg_part = pmt::nth(k,msg);
00074             \textcolor{comment}{// Print identifier (which information)}
00075             std::cout << pmt::symbol\_to\_string(pmt::nth(0,d_msg_part)) << \textcolor{stringliteral}{": "};
00076             \textcolor{keywordflow}{if}(d_store_msg) d_file << pmt::symbol\_to\_string(pmt::nth(0,
      d_msg_part)) << \textcolor{stringliteral}{": "};
00077             \textcolor{comment}{// Print information, every datatype needs an if-statement!}
00078             \textcolor{keywordflow}{if}(pmt::is\_f32vector(pmt::nth(1,d_msg_part)))\{
00079                 d_size_part = pmt::length(pmt::nth(1,d_msg_part));
00080                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} l=0; l<d_size_part; l++)\{
00081                     std::cout << pmt::f32vector\_elements(pmt::nth(1,d_msg_part),d\_size\_part)[l] << \textcolor{stringliteral}{" "};
00082                     \textcolor{keywordflow}{if}(d_store_msg) d_file << pmt::f32vector\_elements(pmt::nth(1,
      d_msg_part),d\_size\_part)[l] << \textcolor{stringliteral}{" "};
00083                 \}
00084             \}
00085             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(pmt::is\_integer(pmt::nth(1,d_msg_part)))\{
00086                 std::cout << pmt::to\_long(pmt::nth(1,d_msg_part)) << \textcolor{stringliteral}{" "};
00087                 \textcolor{keywordflow}{if}(d_store_msg) d_file << pmt::to\_long(pmt::nth(1,d_msg_part)) << \textcolor{stringliteral}{" "};
00088             \}
00089             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(pmt::is\_tuple(pmt::nth(1,d_msg_part)))\{
00090                 std::cout << pmt::to\_uint64(pmt::tuple\_ref(pmt::nth(1,d_msg_part),0)) << \textcolor{stringliteral}{":"} << 
      pmt::to\_double(pmt::tuple\_ref(pmt::nth(1,d_msg_part),1)) << \textcolor{stringliteral}{" "};
00091                 \textcolor{keywordflow}{if}(d_store_msg) d_file << pmt::to\_uint64(pmt::tuple\_ref(pmt::nth(1,
      d_msg_part),0)) << \textcolor{stringliteral}{":"} << pmt::to\_double(pmt::tuple\_ref(pmt::nth(1,d_msg_part),1)) << \textcolor{stringliteral}{" "};
00092             \}
00093             \textcolor{keywordflow}{else}\{
00094                 std::cout << \textcolor{stringliteral}{"Can not identify data type."};
00095                 \textcolor{keywordflow}{if}(d_store_msg) d_file << \textcolor{stringliteral}{"Can not identify data type."};
00096             \}
00097             std::cout << std::endl;
00098             \textcolor{keywordflow}{if}(d_store_msg) d_file << std::endl;
00099         \}
00100         std::cout << std::endl;
00101         \textcolor{keywordflow}{if}(d_store_msg) d_file << std::endl;
00102         
00103         \textcolor{keywordflow}{if}(d_store_msg) d_file.close();
00104     \}
00105 
00106   \} \textcolor{comment}{/* namespace radar */}
00107 \} \textcolor{comment}{/* namespace gr */}
00108 
\end{DoxyCode}
