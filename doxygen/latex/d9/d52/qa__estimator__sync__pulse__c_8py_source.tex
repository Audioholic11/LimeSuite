\subsection{qa\+\_\+estimator\+\_\+sync\+\_\+pulse\+\_\+c.\+py}
\label{qa__estimator__sync__pulse__c_8py_source}\index{/home/erik/prefix/default/src/gr-\/radar-\/dev/python/qa\+\_\+estimator\+\_\+sync\+\_\+pulse\+\_\+c.\+py@{/home/erik/prefix/default/src/gr-\/radar-\/dev/python/qa\+\_\+estimator\+\_\+sync\+\_\+pulse\+\_\+c.\+py}}

\begin{DoxyCode}
00001 \textcolor{comment}{#!/usr/bin/env python}
00002 \textcolor{comment}{# -*- coding: utf-8 -*-}
00003 \textcolor{comment}{# }
00004 \textcolor{comment}{# Copyright 2014 Communications Engineering Lab, KIT.}
00005 \textcolor{comment}{# }
00006 \textcolor{comment}{# This is free software; you can redistribute it and/or modify}
00007 \textcolor{comment}{# it under the terms of the GNU General Public License as published by}
00008 \textcolor{comment}{# the Free Software Foundation; either version 3, or (at your option)}
00009 \textcolor{comment}{# any later version.}
00010 \textcolor{comment}{# }
00011 \textcolor{comment}{# This software is distributed in the hope that it will be useful,}
00012 \textcolor{comment}{# but WITHOUT ANY WARRANTY; without even the implied warranty of}
00013 \textcolor{comment}{# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}
00014 \textcolor{comment}{# GNU General Public License for more details.}
00015 \textcolor{comment}{# }
00016 \textcolor{comment}{# You should have received a copy of the GNU General Public License}
00017 \textcolor{comment}{# along with this software; see the file COPYING.  If not, write to}
00018 \textcolor{comment}{# the Free Software Foundation, Inc., 51 Franklin Street,}
00019 \textcolor{comment}{# Boston, MA 02110-1301, USA.}
00020 \textcolor{comment}{# }
00021 
00022 \textcolor{keyword}{from} gnuradio \textcolor{keyword}{import} gr, gr\_unittest
00023 \textcolor{keyword}{from} gnuradio \textcolor{keyword}{import} blocks
00024 \textcolor{keyword}{import} radar\_swig \textcolor{keyword}{as} radar
00025 \textcolor{keyword}{import} pmt
00026 
00027 \textcolor{keyword}{class }qa_estimator_sync_pulse_c (gr\_unittest.TestCase):
00028 
00029     \textcolor{keyword}{def }setUp (self):
00030         self.tb = gr.top\_block ()
00031 
00032     \textcolor{keyword}{def }tearDown (self):
00033         self.tb = \textcolor{keywordtype}{None}
00034 
00035     \textcolor{keyword}{def }test_001_t (self):
00036         \textcolor{comment}{# set up fg}
00037         test\_len = 1000
00038         packet\_len = test\_len
00039         pulse\_send = (200,300,100)
00040         pulse\_wait = (100,100)
00041         amplitude = 0.5
00042         
00043         num\_skip = 5 \textcolor{comment}{# skip samples with skiphead}
00044         num\_xcorr = 300 \textcolor{comment}{# num of xcorrs to determine delay samples}
00045         
00046         src = radar.signal\_generator\_sync\_pulse\_c(packet\_len,pulse\_send,pulse\_wait,amplitude,\textcolor{stringliteral}{"packet\_len"})
00047         head = blocks.head(8,test\_len)
00048         skiphead = blocks.skiphead(8,num\_skip)
00049         est = radar.estimator\_sync\_pulse\_c(num\_xcorr,\textcolor{stringliteral}{"packet\_len"})
00050         res = radar.print\_results()
00051         debug = blocks.message\_debug()
00052         
00053         self.tb.connect(src,skiphead,head)
00054         self.tb.connect((head,0),(est,0)) \textcolor{comment}{# TX stream (undelayed but skiped)}
00055         self.tb.connect((src,0),(est,1)) \textcolor{comment}{# RX stream (delayed but unskiped)}
00056         self.tb.msg\_connect(est,\textcolor{stringliteral}{'Msg out'},res,\textcolor{stringliteral}{'Msg in'})
00057         self.tb.msg\_connect(est,\textcolor{stringliteral}{'Msg out'},debug,\textcolor{stringliteral}{'store'})
00058         self.tb.run ()
00059         
00060         \textcolor{comment}{# check data}
00061         msg = debug.get\_message(0)
00062         num\_skip\_est = pmt.to\_long(pmt.nth(1,pmt.nth(1,msg)))
00063         self.assertEqual(num\_skip\_est,num\_skip)
00064 
00065 
00066 \textcolor{keywordflow}{if} \_\_name\_\_ == \textcolor{stringliteral}{'\_\_main\_\_'}:
00067     gr\_unittest.run(qa\_estimator\_sync\_pulse\_c)\textcolor{comment}{#, "qa\_estimator\_sync\_pulse\_c.xml")}
\end{DoxyCode}
